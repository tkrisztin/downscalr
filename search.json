[{"path":"https://tkrisztin.github.io/downscalr/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2021 downscalr authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://tkrisztin.github.io/downscalr/articles/downscalr_tutorial.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Downscaling land-use change projections in Argentina --- a tutorial using `downscalr`","text":"downscalr package aims providing users kinds readily accessible way employ DownScale model purposes. DownScale model bridges gap observed land-use change (LUC), drivers LUC aggregate LUC targets. One advantage ability estimate priors using empirical econometric model (observations available), relates set exogenous dynamically updated endogenous variables observed LUC patterns. case, priors straightforwardly refers LUC predictions economoetric model given static /dynamically updated input data. DownScale model compatible GLOBIOM integrated assessment model, can provide consistent high-resolution land-use change projections 5 arcminute resolution. Figure 1 gives overview parts involved downscaling process supposed run course. Note, however, aggregate targets downscaled naturally need provided GLOBIOM. instance, tutorial showcase functionality downscalr package LUC targets Argentina obtained FABLE calculator. Fig. 1 - Overview GLOBIOM DownScale framework follows, process Figure 1 – left right – carried R demonstrated.","code":""},{"path":"https://tkrisztin.github.io/downscalr/articles/downscalr_tutorial.html","id":"getting-started","dir":"Articles","previous_headings":"","what":"Getting started","title":"Downscaling land-use change projections in Argentina --- a tutorial using `downscalr`","text":"can start actual downscaling, required packages attached R session. first three standard packages facilitate data manipulation last one, course, subject tutorial.","code":"#install.packages(\"tidyr\",\"tibble\",\"dplyr\") library(tidyr) library(tibble) library(dplyr)   #devtools::install_github(\"tkrisztin/downscalr\",ref=\"HEAD\") library(downscalr)"},{"path":"https://tkrisztin.github.io/downscalr/articles/downscalr_tutorial.html","id":"input-data-prior-module","dir":"Articles","previous_headings":"Getting started","what":"Input data & Prior module","title":"Downscaling land-use change projections in Argentina --- a tutorial using `downscalr`","text":"input data mostly enters downscaling procedure via Prior module informational basis empirical prediction priors Downscaling module. econometric framework employed Bayesian Multinomial logistic (MNL) model, perceives categorical LUC observations, .e. Y, response explanatory data set, .e. X. Moreover, LUC basically result mapping LU class LU classes. practice implies MNL model estimated LUC origin classes separately, however, sake tutorial limit scope one example consider LUC stemming LU class Cropland.","code":""},{"path":"https://tkrisztin.github.io/downscalr/articles/downscalr_tutorial.html","id":"preliminaries","dir":"Articles","previous_headings":"Getting started > Input data & Prior module","what":"Preliminaries","title":"Downscaling land-use change projections in Argentina --- a tutorial using `downscalr`","text":"First, load examplary data within downscalr package transform necessary format MNL model.","code":"# Set example land use change origin to Cropland example_LU_from <- \"Cropland\"  # load data data(argentina_df,argentina_luc)  # Prepare data for econometric Multinomial logistic (MNL) regression Yraw <- argentina_luc  Xraw <- argentina_df$xmat  Y <- dplyr::filter(Yraw,lu.from == example_LU_from & Ts == 2000) %>%         tidyr::pivot_wider(names_from = lu.to) %>%           tibble::column_to_rownames(var = \"ns\") %>%             dplyr::select(-c(lu.from, Ts))  X <- Xraw %>% tidyr::pivot_wider(names_from = \"ks\") %>%       dplyr::arrange(match(ns,Y$ns)) %>%         tibble::column_to_rownames(var = \"ns\")"},{"path":"https://tkrisztin.github.io/downscalr/articles/downscalr_tutorial.html","id":"estimate-mnl-model","dir":"Articles","previous_headings":"Getting started > Input data & Prior module","what":"Estimate MNL model","title":"Downscaling land-use change projections in Argentina --- a tutorial using `downscalr`","text":"MNL function requires data input matrix format. note, baseline category always set examined LUC origin class, .e. currently set Cropland. inputs control amount burn-draws, .e. \\(niter-nburn\\), Gibbs Sampler prior variance model coefficients \\(A0\\). now can kept default values. Stored results_MNL (apart inputs X,Y & baseline) burn-posterior draws MNL model coefficients corresponding marginal effects. `s basically , now everything want Prior module able proceed.","code":"#Compute MNL model with standard settings baseline <- which(colnames(Y) == example_LU_from)  # Decreased niter = 100 and nburn = 50 for faster computation  results_MNL <- mnlogit(as.matrix(X), as.matrix(Y), baseline, niter = 100, nburn = 50, A0 = 10^4) # Strongly recommended if you have more time:  # results_MNL <- mnlogit(as.matrix(X), as.matrix(Y), baseline, niter = 2000, nburn = 1000, A0 = 10^4)"},{"path":"https://tkrisztin.github.io/downscalr/articles/downscalr_tutorial.html","id":"downscale-module","dir":"Articles","previous_headings":"Getting started","what":"Downscale module","title":"Downscaling land-use change projections in Argentina --- a tutorial using `downscalr`","text":"step aggregate target data comes play actual downscaling applied. ease demonstration, limit downscaling scope target projections corresponding year 2010. Yet, example still enable apply downscaling later projections well. principle difference years given econometric model specification, .e. explanatory data X prior prediction step changes least terms LU class predictor, fact according downscaled projections unit observation previous time period. including dynamically changing covariates via projections added restrictions. default settings automatically considers former, .e. changes LU class, one wishes downscale 2010 onwards. now, refer downscalr documentation one intends use advanced settings.","code":""},{"path":"https://tkrisztin.github.io/downscalr/articles/downscalr_tutorial.html","id":"preliminaries-1","dir":"Articles","previous_headings":"Getting started > Downscale module","what":"Preliminaries","title":"Downscaling land-use change projections in Argentina --- a tutorial using `downscalr`","text":"Set example year, load & prepare target data. Moreover, compute mean coefficient posterior draws transform data matrix X mean coefficient matrix correct long format required function downscale().","code":"# Set example year of downscaling target. e.g. 2010 example_time <- 2010  # Prepare inputs for downscale function ## get target data and filter for year and lu.from according to example, i.e. 2010 & cropland data(argentina_FABLE)  arg_targets_crop_2010 <- dplyr::filter(argentina_FABLE, lu.from == example_LU_from &                             times == example_time)  ## pivot explanatory input data into long format X_long <-  X %>% tibble::rownames_to_column(var=\"ns\") %>%             tidyr::pivot_longer(!ns, names_to=\"ks\", values_to = \"value\")  ## prior oefficients: compute mean of posterior draws & pivot to long format   pred_coeff <- as.data.frame(apply(results_MNL$postb[,-baseline,],c(1,2),mean))  pred_coeff_long <- pred_coeff %>% tibble::rownames_to_column(var=\"ks\") %>%                     tidyr::pivot_longer(!ks, names_to = \"lu.to\", values_to=\"value\") %>%                        dplyr::arrange(lu.to) %>%                          tibble::add_column(lu.from=example_LU_from, .after=\"ks\")  ## starting area should provide information on area of each (higher resolution) grid cell, i.e ns arg_start_areas_crop <- dplyr::filter(argentina_df$lu_levels, lu.from == example_LU_from)"},{"path":"https://tkrisztin.github.io/downscalr/articles/downscalr_tutorial.html","id":"downscaling-computation-and-results","dir":"Articles","previous_headings":"Getting started > Downscale module","what":"Downscaling computation and results","title":"Downscaling land-use change projections in Argentina --- a tutorial using `downscalr`","text":"downscale() function either accepts priors directly computes within passed explanatory mean coefficient data. latter method shown. default downscaling technique applied Bias Correction (BS). Lastly, given example settings remaining inputs downscale function can kept default value. ’s ! successfully downscaled LUC Cropland Argentina target FABLE projections year 2010. results stored results_DS$.res.","code":"results_DS <- downscale(targets = arg_targets_crop_2010,                  start.areas =  arg_start_areas_crop, xmat = X_long, betas = pred_coeff_long)  downscaled_LUC <- results_DS$out.res"},{"path":"https://tkrisztin.github.io/downscalr/articles/downscalr_tutorial.html","id":"visualize-results","dir":"Articles","previous_headings":"","what":"Visualize results","title":"Downscaling land-use change projections in Argentina --- a tutorial using `downscalr`","text":"","code":"#load raster data for argentina data(argentina_raster)  # call plot function & plot downscaled LUC projections from Cropland for the year 2010 LUC_argentina_2010_Crop_plot <- LUC_plot(downscaled_LUC, argentina_raster) #> Loading required package: raster #> Loading required package: sp #>  #> Attaching package: 'raster' #> The following object is masked from 'package:dplyr': #>  #>     select LUC_argentina_2010_Crop_plot$LUC.plot"},{"path":"https://tkrisztin.github.io/downscalr/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Krisztin Tamás. Author, maintainer. Wögerer Michael. Author. Ringwald Leopold. Author.","code":""},{"path":"https://tkrisztin.github.io/downscalr/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Tamás K, Michael W, Leopold R (2022). downscalr: Downscaling land-use change projections. https://github.com/tkrisztin/downscalr, https://tkrisztin.github.io/downscalr/.","code":"@Manual{,   title = {downscalr: Downscaling land-use change projections},   author = {Krisztin Tamás and Wögerer Michael and Ringwald Leopold},   year = {2022},   note = {https://github.com/tkrisztin/downscalr, https://tkrisztin.github.io/downscalr/}, }"},{"path":"https://tkrisztin.github.io/downscalr/index.html","id":"downscalr","dir":"","previous_headings":"","what":"Downscaling land-use change projections","title":"Downscaling land-use change projections","text":"R package downscaling land-use land-use change projections. find information (example vignettes) pkgdown website . package allows downscale land-use land-use change projections models GLOBIOM, CAPRI FABLE models. Development package supported European Union - Directorate General Environment, well European Union’s Partnership Instrument German Federal Ministry Environment, Nature Conservation, Nuclear Safety (BMU) context International Climate Initiative (IKI).","code":""},{"path":"https://tkrisztin.github.io/downscalr/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation:","title":"Downscaling land-use change projections","text":"need R run scripts. R following commands install devtools downscalr packages. Devtools required install packages Github. now, want install package vignette – provides quick guide use downscalr –, knitr rmarkdown required well.","code":"# just install the downscalr package   ## install.packages(\"devtools\")   devtools::install_github(\"tkrisztin/downscalr\", ref=\"HEAD\", repos = \"http://cran.us.r-project.org\")      # install the downscalr package with vignette    # (note: this may take a couple minutes since some computing is required to render the vignette).    ## install.packages(c(\"devtools\", \"knitr\", \"rmarkdown\"))   devtools::install_github(\"tkrisztin/downscalr\", ref=\"HEAD\", build_vignettes = TRUE, repos = \"http://cran.us.r-project.org\")"},{"path":"https://tkrisztin.github.io/downscalr/index.html","id":"running-downscalr","dir":"","previous_headings":"","what":"Running downscalr","title":"Downscaling land-use change projections","text":"followed install instructions vignette , can view step step tutorial via following command R: open tab browser, click “HTML” access tutorial. additional guidance see DownScale package documentation : https://bit.ly/3fiLG3u","code":"browseVignettes(\"downscalr\")"},{"path":"https://tkrisztin.github.io/downscalr/index.html","id":"additional-information","dir":"","previous_headings":"","what":"Additional information","title":"Downscaling land-use change projections","text":"package developed context European Union Biodiversity Climate strategies Assessment (EU BIOCLIMA) project. main project goal review assess EU policies land-use diverse objectives forestry, food production, climate change mitigation biodiversity conservation, assess impacts biodiversity (e.g. species conservation status ecosystems extent condition) carbon stocks flows. package created context SPIPA Argentina project, joint cooperation colleagues National Agricultural Technology Institute. main purpose port IIASA’s DownScale model, easier comparison INTA’s Argentina specific implementation Dinamica EGO purpose downscaling FABLE Calculator output. enables -depth representation high-resolution land-use change projections. Originally downscalr developed provide high-resolution projections GLOBIOM model. However, within course SPIPA Argentina expanded fully compatible FABLE Calculator output. Moreover, code ported R documented thoroughly, enable ease use INTA, Argentinian project partner. Supported :  Downscalr developed financial support European Union’s Partnership Instrument German Federal Ministry Environment, Nature Conservation, Nuclear Safety (BMU) context International Climate Initiative (IKI). contents sole responsibility International Institute Applied Systems Analysis (IIASA) necessarily reflect views funders.","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/LUC_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot function to visualize downscale results — LUC_plot","title":"Plot function to visualize downscale results — LUC_plot","text":"Plot function visualize downscale results","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/LUC_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot function to visualize downscale results — LUC_plot","text":"","code":"LUC_plot(   res,   rasterfile,   year = NULL,   LU = NULL,   color = \"Greens\",   label = \"Area in ha per pixel\" )"},{"path":"https://tkrisztin.github.io/downscalr/reference/LUC_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot function to visualize downscale results — LUC_plot","text":"res Result downscale rasterfile RasterLayer object year Specify dates results plot (res) LU Specify land-use results plot (res) color Pixel color map label Label plot legend","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/LUC_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot function to visualize downscale results — LUC_plot","text":"list containing LUC.plot ggplot object plot.df dataframe used constructing LUC.plot","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/LUC_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot function to visualize downscale results — LUC_plot","text":"","code":"## A basic example"},{"path":"https://tkrisztin.github.io/downscalr/reference/areas.identity.html","id":null,"dir":"Reference","previous_headings":"","what":"Areas identity function over land-uses — areas.identity","title":"Areas identity function over land-uses — areas.identity","text":"Areas identity function land-uses","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/areas.identity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Areas identity function over land-uses — areas.identity","text":"","code":"areas.identity(res, curr.areas, priors, xmat, xmat.proj)"},{"path":"https://tkrisztin.github.io/downscalr/reference/areas.identity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Areas identity function over land-uses — areas.identity","text":"res Result downscale curr.areas Dataframe current areas priors Priors updating xmat X-matrix dataframe xmat.proj Projected x matrix","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/areas.identity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Areas identity function over land-uses — areas.identity","text":"curr.areas ","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/areas.sum_to.html","id":null,"dir":"Reference","previous_headings":"","what":"Areas summing up function over land-use changes — areas.sum_to","title":"Areas summing up function over land-use changes — areas.sum_to","text":"Areas summing function land-use changes","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/areas.sum_to.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Areas summing up function over land-use changes — areas.sum_to","text":"","code":"areas.sum_to(res, curr.areas, priors, xmat, xmat.proj)"},{"path":"https://tkrisztin.github.io/downscalr/reference/areas.sum_to.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Areas summing up function over land-use changes — areas.sum_to","text":"res Result downscale curr.areas Dataframe current areas priors Priors updating xmat X-matrix dataframe xmat.proj Projected x matrix","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/areas.sum_to.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Areas summing up function over land-use changes — areas.sum_to","text":"curr.areas ","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/argentina_FABLE.html","id":null,"dir":"Reference","previous_headings":"","what":"FABLE Calculator projections for Argentina — argentina_FABLE","title":"FABLE Calculator projections for Argentina — argentina_FABLE","text":"FABLE Calculator projections Argentina","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/argentina_FABLE.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"FABLE Calculator projections for Argentina — argentina_FABLE","text":"data frame 150 rows 4 variables: times Time period land-use changes lu.Origin land-use class converion lu.Destination land-use class lu.converted value Ha land converted lu.lu.time period","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/argentina_FABLE.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"FABLE Calculator projections for Argentina — argentina_FABLE","text":"https://www.abstract-landscapes.com/fable-calculator","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/argentina_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Argentina land-use change driver data — argentina_df","title":"Argentina land-use change driver data — argentina_df","text":"Argentina land-use change driver data","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/argentina_df.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Argentina land-use change driver data — argentina_df","text":"list four items: xmat, restrictions, pop_data, lu_levels xmat  data frame 96400 rows 3 variables: ns Pixel ids Argentina ks Variable names value Value variable restrictions  data frame 38560 rows 4 variables: ns Pixel ids Argentina lu.Origin land-use class converion lu.Destination land-use class lu.converted value Binary, 1 denotes conversion lu.lu.allowed pop_data  data frame 84832 rows 4 variables, containing population projections 2050 ns Pixel ids Argentina times Year population projection ks totPop - total population ruralPop - rural population value Number persons lu_levels  data frame 23136 rows 3 variables, containing land-use observations 2000 ns Pixel ids Argentina lu.Land-use class value Ha land","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/argentina_luc.html","id":null,"dir":"Reference","previous_headings":"","what":"Land-use change in Argentina from 2000 to 2020 — argentina_luc","title":"Land-use change in Argentina from 2000 to 2020 — argentina_luc","text":"Land-use change Argentina 2000 2020","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/argentina_luc.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Land-use change in Argentina from 2000 to 2020 — argentina_luc","text":"data frame 277632 rows 5 variables: ns Pixel ids Argentina lu.Origin land-use class converion lu.Destination land-use class lu.converted Ts Time-period; either 2000 (changes 2000 2010) 2010 (changes 2010 2020) value Percent lu.pixel converted","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/argentina_luc.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Land-use change in Argentina from 2000 to 2020 — argentina_luc","text":"MapBiomas","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/argentina_raster.html","id":null,"dir":"Reference","previous_headings":"","what":"List of Argentina key raster objects — argentina_raster","title":"List of Argentina key raster objects — argentina_raster","text":"List Argentina key raster objects","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/argentina_raster.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"List of Argentina key raster objects — argentina_raster","text":"list 3 objects: CRS Coordinate Reference System object values matrix 431 rows 237 cols, !NA elements grid location Argentina extent Extent object Argentina raster map","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/argentina_raster.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"List of Argentina key raster objects — argentina_raster","text":"GLOBIOM map","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_areas.html","id":null,"dir":"Reference","previous_headings":"","what":"Complete input areas — complete_areas","title":"Complete input areas — complete_areas","text":"Complete input areas","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_areas.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Complete input areas — complete_areas","text":"","code":"complete_areas(areas)"},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_areas.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Complete input areas — complete_areas","text":"areas Dataframe areas, must columns ns value","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_areas.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Complete input areas — complete_areas","text":"Completed dataframe lu.combinations Internal function. Adds missing columns completes potential sparse dataframes.","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_betas.html","id":null,"dir":"Reference","previous_headings":"","what":"Complete input betas — complete_betas","title":"Complete input betas — complete_betas","text":"Complete input betas","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_betas.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Complete input betas — complete_betas","text":"","code":"complete_betas(betas)"},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_betas.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Complete input betas — complete_betas","text":"betas Dataframe betas, must columns ks, lu.lu.value","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_betas.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Complete input betas — complete_betas","text":"Completed dataframe, added lu.Internal function. Adds missing columns completes potential sparse dataframes.","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_priors.html","id":null,"dir":"Reference","previous_headings":"","what":"Complete input priors — complete_priors","title":"Complete input priors — complete_priors","text":"Complete input priors","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_priors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Complete input priors — complete_priors","text":"","code":"complete_priors(priors, xmat)"},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_priors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Complete input priors — complete_priors","text":"priors Dataframe priors, must columns ns, lu.value xmat Dataframe xmat, must columns ns, ks value","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_priors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Complete input priors — complete_priors","text":"Completed dataframe lu.combinations Internal function. Adds missing columns completes potential sparse dataframes.","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_restrictions.html","id":null,"dir":"Reference","previous_headings":"","what":"Complete input restrictions — complete_restrictions","title":"Complete input restrictions — complete_restrictions","text":"Complete input restrictions","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_restrictions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Complete input restrictions — complete_restrictions","text":"","code":"complete_restrictions(restrictions, xmat)"},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_restrictions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Complete input restrictions — complete_restrictions","text":"restrictions Dataframe restrictions, must columns ns, lu.value xmat Dataframe xmat, must columns ns, ks value","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_restrictions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Complete input restrictions — complete_restrictions","text":"Completed dataframe lu.combinations Internal function. Adds missing columns completes potential sparse dataframes.","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_targets.html","id":null,"dir":"Reference","previous_headings":"","what":"Complete input targets — complete_targets","title":"Complete input targets — complete_targets","text":"Complete input targets","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_targets.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Complete input targets — complete_targets","text":"","code":"complete_targets(targets)"},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_targets.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Complete input targets — complete_targets","text":"targets Dataframe targets, must columns lu.value","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_targets.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Complete input targets — complete_targets","text":"Completed dataframe lu., times columns combinations Internal function. Adds missing columns completes potential sparse dataframes.","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_xmat.coltypes.html","id":null,"dir":"Reference","previous_headings":"","what":"Complete input xmat.coltypes — complete_xmat.coltypes","title":"Complete input xmat.coltypes — complete_xmat.coltypes","text":"Complete input xmat.coltypes","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_xmat.coltypes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Complete input xmat.coltypes — complete_xmat.coltypes","text":"","code":"complete_xmat.coltypes(xmat.coltypes, xmat)"},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_xmat.coltypes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Complete input xmat.coltypes — complete_xmat.coltypes","text":"xmat.coltypes Dataframe xmat.coltypes, must columns ks value; NULL, created static deprecated: can also vector","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_xmat.coltypes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Complete input xmat.coltypes — complete_xmat.coltypes","text":"Completed dataframe ks values Internal function. Adds missing columns completes potential sparse dataframes.","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_xmat.html","id":null,"dir":"Reference","previous_headings":"","what":"Complete input xmat — complete_xmat","title":"Complete input xmat — complete_xmat","text":"Complete input xmat","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_xmat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Complete input xmat — complete_xmat","text":"","code":"complete_xmat(xmat)"},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_xmat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Complete input xmat — complete_xmat","text":"xmat Dataframe xmat, must columns ns, ks value","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_xmat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Complete input xmat — complete_xmat","text":"Completed dataframe Internal function. Placeholder case needed additional completions.","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_xmat.proj.html","id":null,"dir":"Reference","previous_headings":"","what":"Complete input xmat.proj — complete_xmat.proj","title":"Complete input xmat.proj — complete_xmat.proj","text":"Complete input xmat.proj","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_xmat.proj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Complete input xmat.proj — complete_xmat.proj","text":"","code":"complete_xmat.proj(xmat.proj)"},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_xmat.proj.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Complete input xmat.proj — complete_xmat.proj","text":"xmat.proj Dataframe xmat.proj, must columns ns, ks value","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/complete_xmat.proj.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Complete input xmat.proj — complete_xmat.proj","text":"Completed dataframe times combinations Internal function. Adds missing columns completes potential sparse dataframes.","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/downscale.html","id":null,"dir":"Reference","previous_headings":"","what":"Downscaling of land-use (change) data — downscale","title":"Downscaling of land-use (change) data — downscale","text":"Downscaling land-use (change) data","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/downscale.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Downscaling of land-use (change) data — downscale","text":"","code":"downscale(   targets,   start.areas,   xmat,   betas,   areas.update.fun = areas.sum_to,   xmat.coltypes = NULL,   xmat.proj = NULL,   xmat.dyn.fun = xmat.sum_to,   priors = NULL,   restrictions = NULL,   options = downscale_control() )"},{"path":"https://tkrisztin.github.io/downscalr/reference/downscale.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Downscaling of land-use (change) data — downscale","text":"targets dataframe columns times, lu.(optional), lu.value (targets >= 0) start.areas dataframe areas columns lu.(optional), ns value, areas >= 0 sum(areas) >= sum(targets) xmat dataframe explanatory variables columns ns, ks value betas dataframe coefficients columns ks, lu.(optional), lu.& value areas.update.fun function providing update dynamic xmat columns, must take arguments res, curr.areas, priors, xmat.proj, must return dataframe columns ns, ks & value defaults areas.sum_to() sums lu.xmat.coltypes ks vector, can either \"static\", \"dynamic\", \"projected\" xmat.proj dataframe columns times, ns, ks, must present xmat.coltype specified projected xmat.dyn.fun function providing update dynamic xmat columns, must take arguments res, curr.areas, priors, xmat.proj must return ns x ks(dynamic) columns priors dataframe priors columns ns, lu.(optional), lu.(priors >= 0); betas supplied prior_weights downscale_control regulate weighted. restrictions dataframe columns ns, lu.(optional), lu.value. Values must zero one. restrictions one, MNL function set zero options list solver options. Call downscale_control default options detail.","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/downscale.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Downscaling of land-use (change) data — downscale","text":"list containing .res Dataframe columns times, ns, lu., lu.& value (area allocation) .solver list solver output","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/downscale.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Downscaling of land-use (change) data — downscale","text":"Given p targets matches either projections MNL-type model exogenous priors.","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/downscale.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Downscaling of land-use (change) data — downscale","text":"","code":"require(dplyr) #> Loading required package: dplyr #>  #> Attaching package: ‘dplyr’ #> The following objects are masked from ‘package:stats’: #>  #>     filter, lag #> The following objects are masked from ‘package:base’: #>  #>     intersect, setdiff, setequal, union require(tidyr) #> Loading required package: tidyr require(tibble) #> Loading required package: tibble betas = NULL for (jj in unique(argentina_luc$lu.from)) {  Y = dplyr::filter(argentina_luc,lu.from == jj & Ts == 2000) %>%    pivot_wider(names_from = lu.to)  X = argentina_df$xmat %>% tidyr::pivot_wider(names_from = \"ks\") %>%    dplyr::arrange(match(ns,Y$ns))  Y = Y %>% dplyr::select(-c(lu.from,Ts,ns))  X = X %>% dplyr::select(-c(ns))  res1 <- mnlogit(as.matrix(X), as.matrix(Y),baseline = which(colnames(Y) == jj),           niter = 3,nburn = 2)  betas = betas %>% dplyr::bind_rows(   apply(res1$postb, c(1, 2), mean) %>%    as.data.frame() %>% tibble::rownames_to_column(\"ks\") %>%    pivot_longer(cols = -c(1),names_to = \"lu.to\") %>%    dplyr::mutate(lu.from = jj,.before=\"lu.to\")  ) } #>    |                                                                               |                                                                      |   0%   |                                                                               |=======================                                               |  33%   |                                                                               |===============================================                       |  67%   |                                                                               |======================================================================| 100% #>    |                                                                               |                                                                      |   0%   |                                                                               |=======================                                               |  33%   |                                                                               |===============================================                       |  67%   |                                                                               |======================================================================| 100% #>    |                                                                               |                                                                      |   0%   |                                                                               |=======================                                               |  33%   |                                                                               |===============================================                       |  67%   |                                                                               |======================================================================| 100% #>    |                                                                               |                                                                      |   0%   |                                                                               |=======================                                               |  33%   |                                                                               |===============================================                       |  67%   |                                                                               |======================================================================| 100% #>    |                                                                               |                                                                      |   0%   |                                                                               |=======================                                               |  33%   |                                                                               |===============================================                       |  67%   |                                                                               |======================================================================| 100% #>    |                                                                               |                                                                      |   0%   |                                                                               |=======================                                               |  33%   |                                                                               |===============================================                       |  67%   |                                                                               |======================================================================| 100% ns = unique(argentina_df$lu_levels$ns) priors = data.frame(ns = as.character(ns),lu.from=\"Cropland\",lu.to=\"Forest\",value = runif(length(ns))) res1 = downscale(targets = argentina_FABLE %>% dplyr::filter(times == \"2010\"),          start.areas = argentina_df$lu_levels,          xmat = argentina_df$xmat,          betas = betas %>% dplyr::filter(lu.from!=\"Cropland\" | lu.to!=\"Forest\"),          priors = priors)"},{"path":"https://tkrisztin.github.io/downscalr/reference/downscale_control.html","id":null,"dir":"Reference","previous_headings":"","what":"Get default options for bias corrections solver — downscale_control","title":"Get default options for bias corrections solver — downscale_control","text":"Get default options bias corrections solver","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/downscale_control.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get default options for bias corrections solver — downscale_control","text":"","code":"downscale_control(   solve_fun = \"solve_biascorr\",   algorithm = \"NLOPT_LN_SBPLX\",   xtol_rel = 1e-20,   xtol_abs = 1e-20,   maxeval = 1600,   MAX_EXP = log(.Machine$double.xmax),   cutoff = 0,   redo = 2,   max_diff = 10^-8,   err.txt = \"\",   prior_weights = 0 )"},{"path":"https://tkrisztin.github.io/downscalr/reference/downscale_control.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get default options for bias corrections solver — downscale_control","text":"solve_fun Downscaling algorithm (solve_biascorr.mnl)). algorithm Solver algorithm (see nloptr package documentation detail). xtol_rel Relative tolerance solver. xtol_abs Absolute solver tolerance. maxeval Maximum evaluation solver. MAX_EXP Numerical cutoff MNL function. cutoff Optional cutoff avoid MNL values close zero. redo Maximum number repeats max_diff difference targets larger, redo estimation (helps avoid convergence errors) err.txt Error text caller identification (used debugging) prior_weights Scalar 0 1; betas priors specified value gives weight priors.","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/downscale_control.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get default options for bias corrections solver — downscale_control","text":"List default options bias correction solver","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/downscale_control.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get default options for bias corrections solver — downscale_control","text":"Call function want change default options bias corrections solver.","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/downscale_control.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get default options for bias corrections solver — downscale_control","text":"","code":"opts1 = downscale_control()"},{"path":"https://tkrisztin.github.io/downscalr/reference/err_check_inputs.html","id":null,"dir":"Reference","previous_headings":"","what":"Error check inputs — err_check_inputs","title":"Error check inputs — err_check_inputs","text":"Error check inputs","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/err_check_inputs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Error check inputs — err_check_inputs","text":"","code":"err_check_inputs(   targets,   areas,   xmat,   betas,   areas.update.fun,   xmat.coltypes,   xmat.proj,   xmat.dyn.fun,   priors,   restrictions,   err.txt )"},{"path":"https://tkrisztin.github.io/downscalr/reference/err_check_inputs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Error check inputs — err_check_inputs","text":"targets dataframe columns times, lu.(optional), lu.value (targets >= 0) areas dataframe areas columns lu.(optional), ns value, areas >= 0 sum(areas) >= sum(targets) xmat dataframe explanatory variables columns ks value betas dataframe coefficients columns ks, lu.(optional), lu.& value areas.update.fun function providing update dynamic xmat columns, must take arguments res, curr.areas, priors, xmat.proj, must dataframe columns ns, lu.& value defaults areas.sum_to() sums lu.xmat.coltypes dataframce columns ks string value, can either \"static\", \"dynamic\", \"projected\" xmat.proj dataframe columns times, ns, ks, must present xmat.coltype specified projected xmat.dyn.fun function providing update dynamic xmat columns, must take arguments res, curr.areas, priors, xmat.proj must return ns x ks(dynamic) columns priors dataframe priors (betas supplied) columns ns, lu.(optional), lu.(priors >= 0) restrictions dataframe columns ns, lu.(optional), lu.value. Values must zero one. restrictions one, MNL function set zero Internal function. Must throw errors, return value inputs match specification. Handle error checking Use error checking inputs.","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/mnlogit.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian logit model with Pólya Gamma prior with MCMC — mnlogit","title":"Bayesian logit model with Pólya Gamma prior with MCMC — mnlogit","text":"Bayesian logit model Pólya Gamma prior MCMC","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/mnlogit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian logit model with Pólya Gamma prior with MCMC — mnlogit","text":"","code":"mnlogit(X, Y, baseline = ncol(Y), niter = 1000, nburn = 500, A0 = 10^4)"},{"path":"https://tkrisztin.github.io/downscalr/reference/mnlogit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian logit model with Pólya Gamma prior with MCMC — mnlogit","text":"X n k matrix explanatory variables Y n p matrix dependent variables baseline Baseline class estimation. Parameters set zero. Defaults p-th column. niter Total number MCMC draws nburn Burn-draws MCMC A0 Prior variance scalar slope coefficients","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/mnlogit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian logit model with Pólya Gamma prior with MCMC — mnlogit","text":"list containing postb k x p x (niter - nburn dimensions) array containing posterior draws slope coefficients. marginal_fx k x p x (niter - nburn dimensions) array containing posterior draws marginal effects. X, Y, baseline matrices explanatory dependent variables, defined baseline class.","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/mnlogit.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bayesian logit model with Pólya Gamma prior with MCMC — mnlogit","text":"MCMC estimation multinomial logit model following Polson et al. (2013).","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/mnlogit.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bayesian logit model with Pólya Gamma prior with MCMC — mnlogit","text":"Nicholas G. Polson, James G. Scott, Jesse Windle. Bayesian inference logistic models using Polya-Gamma latent variables. Journal American statistical Association 108.504 (2013): 1339-1349.","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/mnlogit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bayesian logit model with Pólya Gamma prior with MCMC — mnlogit","text":"","code":"n <- 100 p <- 3 k <- 2 X <- cbind(1, matrix(rnorm(n * (k - 1), 0, 2), n, k - 1)) BETA <- matrix(sample(c(-3:3), k * p, replace = TRUE), k, p) BETA[, p] <- 0 Y <- exp(X %*% BETA) / rowSums(exp(X %*% BETA)) res1 <- mnlogit(X, Y) #>    |                                                                               |                                                                      |   0%   |                                                                               |                                                                      |   1%   |                                                                               |=                                                                     |   1%   |                                                                               |=                                                                     |   2%   |                                                                               |==                                                                    |   2%   |                                                                               |==                                                                    |   3%   |                                                                               |==                                                                    |   4%   |                                                                               |===                                                                   |   4%   |                                                                               |===                                                                   |   5%   |                                                                               |====                                                                  |   5%   |                                                                               |====                                                                  |   6%   |                                                                               |=====                                                                 |   6%   |                                                                               |=====                                                                 |   7%   |                                                                               |=====                                                                 |   8%   |                                                                               |======                                                                |   8%   |                                                                               |======                                                                |   9%   |                                                                               |=======                                                               |   9%   |                                                                               |=======                                                               |  10%   |                                                                               |=======                                                               |  11%   |                                                                               |========                                                              |  11%   |                                                                               |========                                                              |  12%   |                                                                               |=========                                                             |  12%   |                                                                               |=========                                                             |  13%   |                                                                               |=========                                                             |  14%   |                                                                               |==========                                                            |  14%   |                                                                               |==========                                                            |  15%   |                                                                               |===========                                                           |  15%   |                                                                               |===========                                                           |  16%   |                                                                               |============                                                          |  16%   |                                                                               |============                                                          |  17%   |                                                                               |============                                                          |  18%   |                                                                               |=============                                                         |  18%   |                                                                               |=============                                                         |  19%   |                                                                               |==============                                                        |  19%   |                                                                               |==============                                                        |  20%   |                                                                               |==============                                                        |  21%   |                                                                               |===============                                                       |  21%   |                                                                               |===============                                                       |  22%   |                                                                               |================                                                      |  22%   |                                                                               |================                                                      |  23%   |                                                                               |================                                                      |  24%   |                                                                               |=================                                                     |  24%   |                                                                               |=================                                                     |  25%   |                                                                               |==================                                                    |  25%   |                                                                               |==================                                                    |  26%   |                                                                               |===================                                                   |  26%   |                                                                               |===================                                                   |  27%   |                                                                               |===================                                                   |  28%   |                                                                               |====================                                                  |  28%   |                                                                               |====================                                                  |  29%   |                                                                               |=====================                                                 |  29%   |                                                                               |=====================                                                 |  30%   |                                                                               |=====================                                                 |  31%   |                                                                               |======================                                                |  31%   |                                                                               |======================                                                |  32%   |                                                                               |=======================                                               |  32%   |                                                                               |=======================                                               |  33%   |                                                                               |=======================                                               |  34%   |                                                                               |========================                                              |  34%   |                                                                               |========================                                              |  35%   |                                                                               |=========================                                             |  35%   |                                                                               |=========================                                             |  36%   |                                                                               |==========================                                            |  36%   |                                                                               |==========================                                            |  37%   |                                                                               |==========================                                            |  38%   |                                                                               |===========================                                           |  38%   |                                                                               |===========================                                           |  39%   |                                                                               |============================                                          |  39%   |                                                                               |============================                                          |  40%   |                                                                               |============================                                          |  41%   |                                                                               |=============================                                         |  41%   |                                                                               |=============================                                         |  42%   |                                                                               |==============================                                        |  42%   |                                                                               |==============================                                        |  43%   |                                                                               |==============================                                        |  44%   |                                                                               |===============================                                       |  44%   |                                                                               |===============================                                       |  45%   |                                                                               |================================                                      |  45%   |                                                                               |================================                                      |  46%   |                                                                               |=================================                                     |  46%   |                                                                               |=================================                                     |  47%   |                                                                               |=================================                                     |  48%   |                                                                               |==================================                                    |  48%   |                                                                               |==================================                                    |  49%   |                                                                               |===================================                                   |  49%   |                                                                               |===================================                                   |  50%   |                                                                               |===================================                                   |  51%   |                                                                               |====================================                                  |  51%   |                                                                               |====================================                                  |  52%   |                                                                               |=====================================                                 |  52%   |                                                                               |=====================================                                 |  53%   |                                                                               |=====================================                                 |  54%   |                                                                               |======================================                                |  54%   |                                                                               |======================================                                |  55%   |                                                                               |=======================================                               |  55%   |                                                                               |=======================================                               |  56%   |                                                                               |========================================                              |  56%   |                                                                               |========================================                              |  57%   |                                                                               |========================================                              |  58%   |                                                                               |=========================================                             |  58%   |                                                                               |=========================================                             |  59%   |                                                                               |==========================================                            |  59%   |                                                                               |==========================================                            |  60%   |                                                                               |==========================================                            |  61%   |                                                                               |===========================================                           |  61%   |                                                                               |===========================================                           |  62%   |                                                                               |============================================                          |  62%   |                                                                               |============================================                          |  63%   |                                                                               |============================================                          |  64%   |                                                                               |=============================================                         |  64%   |                                                                               |=============================================                         |  65%   |                                                                               |==============================================                        |  65%   |                                                                               |==============================================                        |  66%   |                                                                               |===============================================                       |  66%   |                                                                               |===============================================                       |  67%   |                                                                               |===============================================                       |  68%   |                                                                               |================================================                      |  68%   |                                                                               |================================================                      |  69%   |                                                                               |=================================================                     |  69%   |                                                                               |=================================================                     |  70%   |                                                                               |=================================================                     |  71%   |                                                                               |==================================================                    |  71%   |                                                                               |==================================================                    |  72%   |                                                                               |===================================================                   |  72%   |                                                                               |===================================================                   |  73%   |                                                                               |===================================================                   |  74%   |                                                                               |====================================================                  |  74%   |                                                                               |====================================================                  |  75%   |                                                                               |=====================================================                 |  75%   |                                                                               |=====================================================                 |  76%   |                                                                               |======================================================                |  76%   |                                                                               |======================================================                |  77%   |                                                                               |======================================================                |  78%   |                                                                               |=======================================================               |  78%   |                                                                               |=======================================================               |  79%   |                                                                               |========================================================              |  79%   |                                                                               |========================================================              |  80%   |                                                                               |========================================================              |  81%   |                                                                               |=========================================================             |  81%   |                                                                               |=========================================================             |  82%   |                                                                               |==========================================================            |  82%   |                                                                               |==========================================================            |  83%   |                                                                               |==========================================================            |  84%   |                                                                               |===========================================================           |  84%   |                                                                               |===========================================================           |  85%   |                                                                               |============================================================          |  85%   |                                                                               |============================================================          |  86%   |                                                                               |=============================================================         |  86%   |                                                                               |=============================================================         |  87%   |                                                                               |=============================================================         |  88%   |                                                                               |==============================================================        |  88%   |                                                                               |==============================================================        |  89%   |                                                                               |===============================================================       |  89%   |                                                                               |===============================================================       |  90%   |                                                                               |===============================================================       |  91%   |                                                                               |================================================================      |  91%   |                                                                               |================================================================      |  92%   |                                                                               |=================================================================     |  92%   |                                                                               |=================================================================     |  93%   |                                                                               |=================================================================     |  94%   |                                                                               |==================================================================    |  94%   |                                                                               |==================================================================    |  95%   |                                                                               |===================================================================   |  95%   |                                                                               |===================================================================   |  96%   |                                                                               |====================================================================  |  96%   |                                                                               |====================================================================  |  97%   |                                                                               |====================================================================  |  98%   |                                                                               |===================================================================== |  98%   |                                                                               |===================================================================== |  99%   |                                                                               |======================================================================|  99%   |                                                                               |======================================================================| 100% print(BETA) #>      [,1] [,2] [,3] #> [1,]   -1    1    0 #> [2,]    0   -3    0 print(apply(res1$postb, c(1, 2), mean)) #>             [,1]      [,2] [,3] #> [1,] -1.11294366  1.099852    0 #> [2,]  0.01887413 -3.439722    0  require(tidyr) Y = dplyr::filter(argentina_luc,lu.from == \"Cropland\" & Ts == 2000) %>%    pivot_wider(names_from = lu.to) X = argentina_df$xmat %>% tidyr::pivot_wider(names_from = \"ks\") %>%    dplyr::arrange(match(ns,Y$ns)) Y = Y %>% dplyr::select(-c(lu.from,Ts,ns)) X = X %>% dplyr::select(-c(ns)) res1 <- mnlogit(as.matrix(X), as.matrix(Y),baseline = which(colnames(Y) == \"Cropland\"),           niter = 100,nburn = 50) #>    |                                                                               |                                                                      |   0%   |                                                                               |=                                                                     |   1%   |                                                                               |=                                                                     |   2%   |                                                                               |==                                                                    |   3%   |                                                                               |===                                                                   |   4%   |                                                                               |====                                                                  |   5%   |                                                                               |====                                                                  |   6%   |                                                                               |=====                                                                 |   7%   |                                                                               |======                                                                |   8%   |                                                                               |======                                                                |   9%   |                                                                               |=======                                                               |  10%   |                                                                               |========                                                              |  11%   |                                                                               |========                                                              |  12%   |                                                                               |=========                                                             |  13%   |                                                                               |==========                                                            |  14%   |                                                                               |==========                                                            |  15%   |                                                                               |===========                                                           |  16%   |                                                                               |============                                                          |  17%   |                                                                               |=============                                                         |  18%   |                                                                               |=============                                                         |  19%   |                                                                               |==============                                                        |  20%   |                                                                               |===============                                                       |  21%   |                                                                               |===============                                                       |  22%   |                                                                               |================                                                      |  23%   |                                                                               |=================                                                     |  24%   |                                                                               |==================                                                    |  25%   |                                                                               |==================                                                    |  26%   |                                                                               |===================                                                   |  27%   |                                                                               |====================                                                  |  28%   |                                                                               |====================                                                  |  29%   |                                                                               |=====================                                                 |  30%   |                                                                               |======================                                                |  31%   |                                                                               |======================                                                |  32%   |                                                                               |=======================                                               |  33%   |                                                                               |========================                                              |  34%   |                                                                               |========================                                              |  35%   |                                                                               |=========================                                             |  36%   |                                                                               |==========================                                            |  37%   |                                                                               |===========================                                           |  38%   |                                                                               |===========================                                           |  39%   |                                                                               |============================                                          |  40%   |                                                                               |=============================                                         |  41%   |                                                                               |=============================                                         |  42%   |                                                                               |==============================                                        |  43%   |                                                                               |===============================                                       |  44%   |                                                                               |================================                                      |  45%   |                                                                               |================================                                      |  46%   |                                                                               |=================================                                     |  47%   |                                                                               |==================================                                    |  48%   |                                                                               |==================================                                    |  49%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================                                  |  51%   |                                                                               |====================================                                  |  52%   |                                                                               |=====================================                                 |  53%   |                                                                               |======================================                                |  54%   |                                                                               |======================================                                |  55%   |                                                                               |=======================================                               |  56%   |                                                                               |========================================                              |  57%   |                                                                               |=========================================                             |  58%   |                                                                               |=========================================                             |  59%   |                                                                               |==========================================                            |  60%   |                                                                               |===========================================                           |  61%   |                                                                               |===========================================                           |  62%   |                                                                               |============================================                          |  63%   |                                                                               |=============================================                         |  64%   |                                                                               |==============================================                        |  65%   |                                                                               |==============================================                        |  66%   |                                                                               |===============================================                       |  67%   |                                                                               |================================================                      |  68%   |                                                                               |================================================                      |  69%   |                                                                               |=================================================                     |  70%   |                                                                               |==================================================                    |  71%   |                                                                               |==================================================                    |  72%   |                                                                               |===================================================                   |  73%   |                                                                               |====================================================                  |  74%   |                                                                               |====================================================                  |  75%   |                                                                               |=====================================================                 |  76%   |                                                                               |======================================================                |  77%   |                                                                               |=======================================================               |  78%   |                                                                               |=======================================================               |  79%   |                                                                               |========================================================              |  80%   |                                                                               |=========================================================             |  81%   |                                                                               |=========================================================             |  82%   |                                                                               |==========================================================            |  83%   |                                                                               |===========================================================           |  84%   |                                                                               |============================================================          |  85%   |                                                                               |============================================================          |  86%   |                                                                               |=============================================================         |  87%   |                                                                               |==============================================================        |  88%   |                                                                               |==============================================================        |  89%   |                                                                               |===============================================================       |  90%   |                                                                               |================================================================      |  91%   |                                                                               |================================================================      |  92%   |                                                                               |=================================================================     |  93%   |                                                                               |==================================================================    |  94%   |                                                                               |==================================================================    |  95%   |                                                                               |===================================================================   |  96%   |                                                                               |====================================================================  |  97%   |                                                                               |===================================================================== |  98%   |                                                                               |===================================================================== |  99%   |                                                                               |======================================================================| 100% print(apply(res1$postb, c(1, 2), mean)) #>                  Cropland        Forest     OtherLand       Pasture #> Intercept               0 -5.671248e+00 -6.528701e+00 -8.399039e+00 #> Cropland                0 -1.079250e-03 -3.872827e-03 -1.159637e-02 #> Forest                  0  5.847012e-03 -1.038301e-02 -4.491024e-03 #> OtherLand               0 -1.708457e-02  1.217026e-02 -1.689234e-03 #> Pasture                 0  9.297662e-03 -7.711933e-03  4.392276e-03 #> Plantations             0 -8.867677e-02  1.725866e-02 -3.428895e-02 #> Urban                   0 -2.765911e-01 -1.965123e+00 -1.637988e+00 #> MeanTemp                0  2.010661e-02 -5.858793e-03 -4.437888e-03 #> MeanPrecip              0 -1.065465e-04 -6.163078e-04 -6.662183e-04 #> HarvWood                0 -3.529668e-01  5.555540e-01 -3.857881e-01 #> HarvCost                0  6.810672e-03 -2.798845e-03  2.901160e-05 #> GRASYLD                 0 -3.295553e-02  2.985040e-03  6.921248e-02 #> meanTimeToMarket        0 -4.218710e-04 -3.081167e-04  1.051645e-03 #> totPop                  0 -9.943003e-05  6.642529e-05 -1.805148e-05 #> ruralPop                0  4.404005e-01 -1.429843e+00 -1.102619e+00 #> Altitude                0  8.432309e-04 -6.354777e-04 -3.806787e-04 #> Slope                   0 -3.524590e-02 -2.947219e-02  8.719892e-02 #> Soil2_Medium            0 -1.946997e+00  2.512621e+00  2.562717e+00 #> Soil3_Heavy             0 -1.662351e+00  4.864185e-01  3.518412e+00 #> Soil4_Stony             0 -2.415927e+00  2.178201e+00  1.884349e+00 #> MEANYLD                 0 -2.849295e+01 -1.748869e+01 -1.734308e+01 #> HI_MEAN                 0  9.830121e-01  6.411529e+00  1.168552e+01 #> LI_MEAN                 0  1.542730e+01  2.108230e-03 -6.264979e+00 #> IR_MEAN                 0  5.954332e+00  3.237372e+00  3.986092e+00 #> SS_MEAN                 0  6.677630e+00  8.453095e+00  8.278158e+00 #>                    Plantations         Urban #> Intercept        -3.999460e+00 -7.336083e+00 #> Cropland         -5.161099e-03  1.920703e-02 #> Forest           -1.934289e-02  2.369079e-03 #> OtherLand         1.170288e-02 -3.596110e-03 #> Pasture          -4.106129e-03 -8.220601e-03 #> Plantations       7.025245e-03 -2.304595e-02 #> Urban            -1.104221e+00 -1.138833e-02 #> MeanTemp          6.372875e-03  1.654639e-02 #> MeanPrecip       -1.743531e-04 -3.209959e-04 #> HarvWood          1.530196e+00 -1.051520e+00 #> HarvCost         -1.869684e-02  7.192316e-03 #> GRASYLD           2.237018e-02 -3.671575e-02 #> meanTimeToMarket -3.215973e-04 -1.948653e-03 #> totPop           -2.644834e-04 -3.508108e-05 #> ruralPop         -1.512750e+00  1.434146e+00 #> Altitude         -8.832056e-04 -9.591334e-04 #> Slope            -2.451621e-02  1.067321e-02 #> Soil2_Medium      4.019605e-01  3.874393e-01 #> Soil3_Heavy       1.688123e+00  3.010910e+00 #> Soil4_Stony       6.580436e-01  8.115933e-02 #> MEANYLD           2.278493e+01 -5.286741e+01 #> HI_MEAN          -1.164778e-01 -1.810549e+01 #> LI_MEAN          -1.050773e+01  5.041086e+01 #> IR_MEAN          -6.904670e+00  1.249296e+01 #> SS_MEAN          -5.189626e+00  8.601603e+00"},{"path":"https://tkrisztin.github.io/downscalr/reference/mu.mnl.html","id":null,"dir":"Reference","previous_headings":"","what":"Multinomial logit mean calculation with restrictions and cutoff — mu.mnl","title":"Multinomial logit mean calculation with restrictions and cutoff — mu.mnl","text":"Multinomial logit mean calculation restrictions cutoff","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/mu.mnl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multinomial logit mean calculation with restrictions and cutoff — mu.mnl","text":"","code":"mu.mnl(x, mu, areas, restrictions = NULL, cutoff = 0)"},{"path":"https://tkrisztin.github.io/downscalr/reference/mu.mnl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multinomial logit mean calculation with restrictions and cutoff — mu.mnl","text":"x Bias correction parameters mu Means class areas Vector areas restrictions Optional restrictions. Binary, 1, log-odds set zero cutoff Optional, defaults zero. set, log-odds cutoff set zero","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/mu.mnl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multinomial logit mean calculation with restrictions and cutoff — mu.mnl","text":"Returns vector log-odds times areas","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/solve_biascorr.mnl.html","id":null,"dir":"Reference","previous_headings":"","what":"Bias correction solver for multinomial logit type problems — solve_biascorr.mnl","title":"Bias correction solver for multinomial logit type problems — solve_biascorr.mnl","text":"Bias correction solver multinomial logit type problems","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/solve_biascorr.mnl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bias correction solver for multinomial logit type problems — solve_biascorr.mnl","text":"","code":"solve_biascorr.mnl(   targets,   areas,   xmat,   betas,   priors = NULL,   restrictions = NULL,   options = downscale_control() )"},{"path":"https://tkrisztin.github.io/downscalr/reference/solve_biascorr.mnl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bias correction solver for multinomial logit type problems — solve_biascorr.mnl","text":"targets dataframe columns lu., lu.value (targets >= 0) areas dataframe areas columns lu., ns value, areas >= 0 sum(areas) >= sum(targets) xmat dataframe explanatory variables columns ks value betas dataframe coefficients columns ks, lu., lu.& value priors dataframe priors (betas supplied) columns ns, lu., lu.(priors >= 0) restrictions dataframe columns ns, lu., lu.value. Values must zero one. restrictions one, MNL function set zero options list solver options. Call downscale_control default options detail.","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/solve_biascorr.mnl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bias correction solver for multinomial logit type problems — solve_biascorr.mnl","text":"list containing .res n x p matrix area allocations .solver list solver output","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/solve_biascorr.mnl.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bias correction solver for multinomial logit type problems — solve_biascorr.mnl","text":"Given p targets matches either projections MNL-type model exogeneous priors. call functions directly, call downscale instead. min $$\\sum  (  z ij areas_i  - targets_j )^2$$ s.t. $$ z_ij = \\mu_ij$$ $$\\mu_ij = \\lambda_ij / (1 + \\sum \\lambda_ij )$$ $$\\lambda_ij = x_j + \\exp xmat_i betas_j$$ \\(\\lambda_ij = x_j + priors_ij\\) $$x_j >= 0$$ \\(= 1,...,n\\)  \\(j = 1,...,n\\). #' target either betas xmats priors supplied. Priors strictly larger equal zero. cutoff specified, \\(z_ij\\) defined \\(mu_ij > cutoff\\). \\(mu_ij <= cutoff\\) \\(z_ij = 0\\). Per default cutoff set zero. Targets specified dataframe least lu.value column. targets must larger equal zero. lu.column supplied specified arguments. case bias correction performed lu.classes. Areas correspond either areas per pixel (ns), value optionally lu.pixel. areas must larger function expects lu.Restrictions binary optional. restrictions supplied, case \\(restrictions_ij = 1\\)  \\(z_ij = 0\\).","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/solve_biascorr.mnl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bias correction solver for multinomial logit type problems — solve_biascorr.mnl","text":"","code":"## A basic example"},{"path":"https://tkrisztin.github.io/downscalr/reference/sqr_diff.mnl.html","id":null,"dir":"Reference","previous_headings":"","what":"Squared differences optimization function with multinomial logit — sqr_diff.mnl","title":"Squared differences optimization function with multinomial logit — sqr_diff.mnl","text":"Squared differences optimization function multinomial logit","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/sqr_diff.mnl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Squared differences optimization function with multinomial logit — sqr_diff.mnl","text":"","code":"sqr_diff.mnl(x, mu, areas, targets, restrictions, cutoff = 0)"},{"path":"https://tkrisztin.github.io/downscalr/reference/sqr_diff.mnl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Squared differences optimization function with multinomial logit — sqr_diff.mnl","text":"x Bias correction parameters mu Means class areas Vector areas targets Targets match restrictions Optional restrictions. Binary, 1, log-odds set zero cutoff Optional, defaults zero. set, log-odds cutoff set zero","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/sqr_diff.mnl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Squared differences optimization function with multinomial logit — sqr_diff.mnl","text":"Squared differences optimized values targets","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/xmat.sum_to.html","id":null,"dir":"Reference","previous_headings":"","what":"xmat summing up function over land-use changes — xmat.sum_to","title":"xmat summing up function over land-use changes — xmat.sum_to","text":"xmat summing function land-use changes","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/xmat.sum_to.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"xmat summing up function over land-use changes — xmat.sum_to","text":"","code":"xmat.sum_to(res, curr.areas, priors, xmat, xmat.proj)"},{"path":"https://tkrisztin.github.io/downscalr/reference/xmat.sum_to.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"xmat summing up function over land-use changes — xmat.sum_to","text":"res Result downscale curr.areas Dataframe current areas priors Priors updating xmat X-matrix dataframe xmat.proj Projected x matrix","code":""},{"path":"https://tkrisztin.github.io/downscalr/reference/xmat.sum_to.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"xmat summing up function over land-use changes — xmat.sum_to","text":"curr.xmat Dynamically updated xmat columns","code":""}]
